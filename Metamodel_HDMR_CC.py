"""
 Metamodel_HDMR.py, translated by @author: kkuriyan, 01-10-2018 from Metamodel_HDMR.m 

 This is a HDMR file. It has been built with inputs normalized to [0, 1] range and matched to the desired/computed ouput 
 So it reads in inputs in [0, 1] and calculates the appropriate output 

 x_in      : is of size "nxN" where n=number of inputs, N=number of
             samples
 varargin  : can be empty = [] (currently not used by the code)
 y_out     : should be of size "m1xm2xN" where m1=number of outputs,
             m2=number of time steps, N=number of samples
 varargout : is set varargout{1}=m1 and varargout{2}=m2 

"""


import sys
import numpy as np
import LegendreShiftPoly as lsp

def Metamodel_HDMR(x_in, *varargin):

	n = 23					# number of inputs
	N = 512					# not used
	m1 = 1					# number of outputs
	m2 = 1					# number of time points
	varargout = (m1, m2)			# not currently used

#
#   HDMR Equations
#

# Set the maxAlpha and maxBeta
	maxAlpha = 3
	maxBeta = 1

# Set the mean (of size m1-m2)
	f0 = np.zeros((m1,m2))
	f0[:,:] = [\
			[0.268359795349318	]\
		]

# Set the alphas (of size m1-m2-n-maxAlpha)
	alpha = np.zeros((m1,m2,n,maxAlpha))
	alpha[0,0,:,:] = [\
			[-0.000842562302553652,0.00209390006176177,0.00159872429335332	],\
			[0.0251638224746715,-0.00550222164905706,-0.000197861011176364	],\
			[-0.00168940838422544,0.000761476402229946,-0.000209910221698159	],\
			[0.0012696120462841,-0.00118903930105401,-0.00212092208060569	],\
			[0.00162504664370203,-0.00246221701714591,-0.00164457052949666	],\
			[-0.00145521286066348,-0.00221442204947271,0.00302797740217021	],\
			[0.000804112835308983,-0.00031286817981146,0.00175398803462634	],\
			[0.00159366535520431,0.00315937831245638,0.000336835404326468	],\
			[-0.000432617886948638,-0.00100749360354327,0.000952712686823976	],\
			[0.00061104825006997,-0.00211483942581005,-0.00209674484251686	],\
			[-0.0441182113576581,0.0124613952342273,-0.0122815251697838	],\
			[0.00194611498879306,-0.000349524771682174,-0.00269552413833199	],\
			[-0.0427404908391264,0.00723598237032653,-0.00311999173431409	],\
			[0.000832406071705134,-0.00180515479514564,0.0021409436684601	],\
			[-9.3609951126754E-05,0.00163916074442128,0.00104495312608054	],\
			[-0.000801836975316727,0.000160610168446131,-0.000907421000252793	],\
			[-0.00104242181477275,0.00253116349331334,-0.000432943417176936	],\
			[0.00011219364898416,-0.00150246258586371,0.00291677219035332	],\
			[1.58264648692992E-05,0.00418984060710859,-0.00155701491585058	],\
			[-0.00360595332753256,0.00165222937417345,0.000741369881244297	],\
			[0.00257574572655586,-0.00142135645553129,-0.000349473977743383	],\
			[0.00118967270281218,0.00138053094733077,0.000155724041043973	],\
			[-5.84900162559724E-05,-0.000232296679071299,-0.00162397794126053	]\
		]

# Set the betas (of size m1-m2-(n-1)-n-maxBeta-maxBeta)
	beta = np.zeros((m1,m2,n-1,n,maxBeta,maxBeta))
	beta[0,0,0,1,:,:] = [\
			[-0.00121541607887082	]\
		]
	beta[0,0,0,2,:,:] = [\
			[0.0033000213383149	]\
		]
	beta[0,0,0,3,:,:] = [\
			[-0.000534259434369719	]\
		]
	beta[0,0,0,4,:,:] = [\
			[-0.00249175336726692	]\
		]
	beta[0,0,0,5,:,:] = [\
			[0.000989767022117478	]\
		]
	beta[0,0,0,6,:,:] = [\
			[-0.00270681097866189	]\
		]
	beta[0,0,0,7,:,:] = [\
			[-0.000438513679492079	]\
		]
	beta[0,0,0,8,:,:] = [\
			[-0.00186332332826744	]\
		]
	beta[0,0,0,9,:,:] = [\
			[0.000288502771553481	]\
		]
	beta[0,0,0,10,:,:] = [\
			[-0.000747390601315839	]\
		]
	beta[0,0,0,11,:,:] = [\
			[0.00250167859710576	]\
		]
	beta[0,0,0,12,:,:] = [\
			[-0.00123114751604077	]\
		]
	beta[0,0,0,13,:,:] = [\
			[0.0010481443366344	]\
		]
	beta[0,0,0,14,:,:] = [\
			[-0.000386726827791738	]\
		]
	beta[0,0,0,15,:,:] = [\
			[0.000532249891206527	]\
		]
	beta[0,0,0,16,:,:] = [\
			[-0.00130118063762638	]\
		]
	beta[0,0,0,17,:,:] = [\
			[-0.00162229955461784	]\
		]
	beta[0,0,0,18,:,:] = [\
			[-0.000965640065410344	]\
		]
	beta[0,0,0,19,:,:] = [\
			[0.000631817841240299	]\
		]
	beta[0,0,0,20,:,:] = [\
			[0.000993239125936524	]\
		]
	beta[0,0,0,21,:,:] = [\
			[0.0023774037378364	]\
		]
	beta[0,0,0,22,:,:] = [\
			[0.00322961879219612	]\
		]
	beta[0,0,1,2,:,:] = [\
			[0.00209496201080366	]\
		]
	beta[0,0,1,3,:,:] = [\
			[-0.000579347003054164	]\
		]
	beta[0,0,1,4,:,:] = [\
			[-0.00449249806999965	]\
		]
	beta[0,0,1,5,:,:] = [\
			[-0.000501719447737664	]\
		]
	beta[0,0,1,6,:,:] = [\
			[-0.00176617522944586	]\
		]
	beta[0,0,1,7,:,:] = [\
			[-0.00124055081967605	]\
		]
	beta[0,0,1,8,:,:] = [\
			[0.00139953623127269	]\
		]
	beta[0,0,1,9,:,:] = [\
			[0.00120608980507384	]\
		]
	beta[0,0,1,10,:,:] = [\
			[-0.00408148522047416	]\
		]
	beta[0,0,1,11,:,:] = [\
			[0.00225983468773056	]\
		]
	beta[0,0,1,12,:,:] = [\
			[-0.00537932915179933	]\
		]
	beta[0,0,1,13,:,:] = [\
			[0.000392597575385559	]\
		]
	beta[0,0,1,14,:,:] = [\
			[0.00118133154456585	]\
		]
	beta[0,0,1,15,:,:] = [\
			[-0.000232561722987846	]\
		]
	beta[0,0,1,16,:,:] = [\
			[0.00128756014215647	]\
		]
	beta[0,0,1,17,:,:] = [\
			[-0.00101705524974074	]\
		]
	beta[0,0,1,18,:,:] = [\
			[-0.000720647321699774	]\
		]
	beta[0,0,1,19,:,:] = [\
			[0.00170992719101564	]\
		]
	beta[0,0,1,20,:,:] = [\
			[0.00064425596833962	]\
		]
	beta[0,0,1,21,:,:] = [\
			[-0.000110663289367477	]\
		]
	beta[0,0,1,22,:,:] = [\
			[0.0035540219499178	]\
		]
	beta[0,0,2,3,:,:] = [\
			[0.00201595755439261	]\
		]
	beta[0,0,2,4,:,:] = [\
			[-0.000336329921320636	]\
		]
	beta[0,0,2,5,:,:] = [\
			[-0.000250138818604027	]\
		]
	beta[0,0,2,6,:,:] = [\
			[-0.00464990854510691	]\
		]
	beta[0,0,2,7,:,:] = [\
			[0.00386835656154056	]\
		]
	beta[0,0,2,8,:,:] = [\
			[0.00356499277155756	]\
		]
	beta[0,0,2,9,:,:] = [\
			[-0.000338521567278165	]\
		]
	beta[0,0,2,10,:,:] = [\
			[0.000350596648248353	]\
		]
	beta[0,0,2,11,:,:] = [\
			[-0.00178270418056928	]\
		]
	beta[0,0,2,12,:,:] = [\
			[-0.00317534768948621	]\
		]
	beta[0,0,2,13,:,:] = [\
			[0.000997607668518697	]\
		]
	beta[0,0,2,14,:,:] = [\
			[-0.0013226775727627	]\
		]
	beta[0,0,2,15,:,:] = [\
			[-0.002717168411713	]\
		]
	beta[0,0,2,16,:,:] = [\
			[0.00302666323263599	]\
		]
	beta[0,0,2,17,:,:] = [\
			[0.000400634420247993	]\
		]
	beta[0,0,2,18,:,:] = [\
			[-0.00041232776067495	]\
		]
	beta[0,0,2,19,:,:] = [\
			[0.00208379204053768	]\
		]
	beta[0,0,2,20,:,:] = [\
			[0.00195386645558379	]\
		]
	beta[0,0,2,21,:,:] = [\
			[0.00220093979742462	]\
		]
	beta[0,0,2,22,:,:] = [\
			[0.00292585229247911	]\
		]
	beta[0,0,3,4,:,:] = [\
			[0.000593056558075499	]\
		]
	beta[0,0,3,5,:,:] = [\
			[-0.000921161066004642	]\
		]
	beta[0,0,3,6,:,:] = [\
			[-0.0010062719229829	]\
		]
	beta[0,0,3,7,:,:] = [\
			[0.00186011423565457	]\
		]
	beta[0,0,3,8,:,:] = [\
			[0.00106392649878875	]\
		]
	beta[0,0,3,9,:,:] = [\
			[0.000886700100439342	]\
		]
	beta[0,0,3,10,:,:] = [\
			[1.87719777358998E-05	]\
		]
	beta[0,0,3,11,:,:] = [\
			[-0.000504919215152369	]\
		]
	beta[0,0,3,12,:,:] = [\
			[0.000879963377637936	]\
		]
	beta[0,0,3,13,:,:] = [\
			[-0.00218701413679522	]\
		]
	beta[0,0,3,14,:,:] = [\
			[-0.000261590412713719	]\
		]
	beta[0,0,3,15,:,:] = [\
			[-0.000126363485104758	]\
		]
	beta[0,0,3,16,:,:] = [\
			[0.000188305793409602	]\
		]
	beta[0,0,3,17,:,:] = [\
			[-0.00134546413953601	]\
		]
	beta[0,0,3,18,:,:] = [\
			[0.000395365732313013	]\
		]
	beta[0,0,3,19,:,:] = [\
			[4.80526616672277E-05	]\
		]
	beta[0,0,3,20,:,:] = [\
			[0.000448418897874394	]\
		]
	beta[0,0,3,21,:,:] = [\
			[-0.000775780817941835	]\
		]
	beta[0,0,3,22,:,:] = [\
			[0.00329848619583093	]\
		]
	beta[0,0,4,5,:,:] = [\
			[0.00272763174626639	]\
		]
	beta[0,0,4,6,:,:] = [\
			[0.00146588871406014	]\
		]
	beta[0,0,4,7,:,:] = [\
			[0.00164896946827235	]\
		]
	beta[0,0,4,8,:,:] = [\
			[-0.000827356755315782	]\
		]
	beta[0,0,4,9,:,:] = [\
			[0.00108668788195551	]\
		]
	beta[0,0,4,10,:,:] = [\
			[0.00311690775097288	]\
		]
	beta[0,0,4,11,:,:] = [\
			[-0.00101023080032162	]\
		]
	beta[0,0,4,12,:,:] = [\
			[0.000386110795834071	]\
		]
	beta[0,0,4,13,:,:] = [\
			[-0.000685731464151214	]\
		]
	beta[0,0,4,14,:,:] = [\
			[-0.00188172283016207	]\
		]
	beta[0,0,4,15,:,:] = [\
			[0.00140820198693891	]\
		]
	beta[0,0,4,16,:,:] = [\
			[0.000699749254610001	]\
		]
	beta[0,0,4,17,:,:] = [\
			[0.000676380747190004	]\
		]
	beta[0,0,4,18,:,:] = [\
			[-0.000319475205146499	]\
		]
	beta[0,0,4,19,:,:] = [\
			[-0.0029097040353305	]\
		]
	beta[0,0,4,20,:,:] = [\
			[0.00131388844800219	]\
		]
	beta[0,0,4,21,:,:] = [\
			[-0.00277658967475513	]\
		]
	beta[0,0,4,22,:,:] = [\
			[-0.000833216489916863	]\
		]
	beta[0,0,5,6,:,:] = [\
			[0.000677479446510003	]\
		]
	beta[0,0,5,7,:,:] = [\
			[-0.00314945902187503	]\
		]
	beta[0,0,5,8,:,:] = [\
			[-0.000202303144606972	]\
		]
	beta[0,0,5,9,:,:] = [\
			[0.00157309464099801	]\
		]
	beta[0,0,5,10,:,:] = [\
			[0.000746909224738545	]\
		]
	beta[0,0,5,11,:,:] = [\
			[0.00236500233665068	]\
		]
	beta[0,0,5,12,:,:] = [\
			[-0.000562374230097594	]\
		]
	beta[0,0,5,13,:,:] = [\
			[0.00108412751299088	]\
		]
	beta[0,0,5,14,:,:] = [\
			[-0.0016884026362665	]\
		]
	beta[0,0,5,15,:,:] = [\
			[-0.000831877728783972	]\
		]
	beta[0,0,5,16,:,:] = [\
			[-0.00066864036235033	]\
		]
	beta[0,0,5,17,:,:] = [\
			[-0.00124058318314405	]\
		]
	beta[0,0,5,18,:,:] = [\
			[0.00256573968586101	]\
		]
	beta[0,0,5,19,:,:] = [\
			[-0.00245372356410431	]\
		]
	beta[0,0,5,20,:,:] = [\
			[0.000564996025775097	]\
		]
	beta[0,0,5,21,:,:] = [\
			[0.000173359147199393	]\
		]
	beta[0,0,5,22,:,:] = [\
			[0.000655680729803758	]\
		]
	beta[0,0,6,7,:,:] = [\
			[0.00428744028129655	]\
		]
	beta[0,0,6,8,:,:] = [\
			[-0.00204072781818552	]\
		]
	beta[0,0,6,9,:,:] = [\
			[0.000173466206058279	]\
		]
	beta[0,0,6,10,:,:] = [\
			[0.00011237465602643	]\
		]
	beta[0,0,6,11,:,:] = [\
			[-0.00054092569402178	]\
		]
	beta[0,0,6,12,:,:] = [\
			[-0.000685533173871116	]\
		]
	beta[0,0,6,13,:,:] = [\
			[0.00380385580761414	]\
		]
	beta[0,0,6,14,:,:] = [\
			[-0.00273334751109936	]\
		]
	beta[0,0,6,15,:,:] = [\
			[-0.000246792119030216	]\
		]
	beta[0,0,6,16,:,:] = [\
			[-0.00092802040155453	]\
		]
	beta[0,0,6,17,:,:] = [\
			[0.00163070888619632	]\
		]
	beta[0,0,6,18,:,:] = [\
			[-0.000293784080020822	]\
		]
	beta[0,0,6,19,:,:] = [\
			[0.000421043496950707	]\
		]
	beta[0,0,6,20,:,:] = [\
			[-0.00118074971454063	]\
		]
	beta[0,0,6,21,:,:] = [\
			[0.00108801843037863	]\
		]
	beta[0,0,6,22,:,:] = [\
			[-0.000322894824932977	]\
		]
	beta[0,0,7,8,:,:] = [\
			[-0.00182254182235725	]\
		]
	beta[0,0,7,9,:,:] = [\
			[0.00145197376143459	]\
		]
	beta[0,0,7,10,:,:] = [\
			[-0.00082514645851347	]\
		]
	beta[0,0,7,11,:,:] = [\
			[-0.000767802031556644	]\
		]
	beta[0,0,7,12,:,:] = [\
			[0.00470706731345462	]\
		]
	beta[0,0,7,13,:,:] = [\
			[0.00181766482523819	]\
		]
	beta[0,0,7,14,:,:] = [\
			[0.00437188060505701	]\
		]
	beta[0,0,7,15,:,:] = [\
			[0.00190823489659068	]\
		]
	beta[0,0,7,16,:,:] = [\
			[-0.00120857442402063	]\
		]
	beta[0,0,7,17,:,:] = [\
			[-3.90249495482431E-05	]\
		]
	beta[0,0,7,18,:,:] = [\
			[-0.000428854020331681	]\
		]
	beta[0,0,7,19,:,:] = [\
			[-0.00105302040921204	]\
		]
	beta[0,0,7,20,:,:] = [\
			[-0.000215073430413758	]\
		]
	beta[0,0,7,21,:,:] = [\
			[-0.00317798481244882	]\
		]
	beta[0,0,7,22,:,:] = [\
			[-0.000981718697178964	]\
		]
	beta[0,0,8,9,:,:] = [\
			[0.000354408425446975	]\
		]
	beta[0,0,8,10,:,:] = [\
			[-0.000872594147276503	]\
		]
	beta[0,0,8,11,:,:] = [\
			[0.000959031029891248	]\
		]
	beta[0,0,8,12,:,:] = [\
			[0.00162657358019755	]\
		]
	beta[0,0,8,13,:,:] = [\
			[-0.00141905140462529	]\
		]
	beta[0,0,8,14,:,:] = [\
			[0.00192970051322842	]\
		]
	beta[0,0,8,15,:,:] = [\
			[-0.00207439058543637	]\
		]
	beta[0,0,8,16,:,:] = [\
			[-0.000365846910527728	]\
		]
	beta[0,0,8,17,:,:] = [\
			[0.000984567193543178	]\
		]
	beta[0,0,8,18,:,:] = [\
			[0.00102984363801352	]\
		]
	beta[0,0,8,19,:,:] = [\
			[0.00056653714659539	]\
		]
	beta[0,0,8,20,:,:] = [\
			[0.00645537926261104	]\
		]
	beta[0,0,8,21,:,:] = [\
			[-0.00238469584066492	]\
		]
	beta[0,0,8,22,:,:] = [\
			[0.00123479477570046	]\
		]
	beta[0,0,9,10,:,:] = [\
			[0.000879402983928334	]\
		]
	beta[0,0,9,11,:,:] = [\
			[0.00228031518257386	]\
		]
	beta[0,0,9,12,:,:] = [\
			[0.000410749171471775	]\
		]
	beta[0,0,9,13,:,:] = [\
			[0.000670863128314109	]\
		]
	beta[0,0,9,14,:,:] = [\
			[0.00207655932277574	]\
		]
	beta[0,0,9,15,:,:] = [\
			[0.000426615786126871	]\
		]
	beta[0,0,9,16,:,:] = [\
			[0.000281419735932256	]\
		]
	beta[0,0,9,17,:,:] = [\
			[-0.00338036024893533	]\
		]
	beta[0,0,9,18,:,:] = [\
			[-0.00175069884868296	]\
		]
	beta[0,0,9,19,:,:] = [\
			[0.000805114594988386	]\
		]
	beta[0,0,9,20,:,:] = [\
			[8.32477155060338E-05	]\
		]
	beta[0,0,9,21,:,:] = [\
			[-0.00209441378375835	]\
		]
	beta[0,0,9,22,:,:] = [\
			[0.000650750847363184	]\
		]
	beta[0,0,10,11,:,:] = [\
			[0.000826006068336239	]\
		]
	beta[0,0,10,12,:,:] = [\
			[0.00587538609261799	]\
		]
	beta[0,0,10,13,:,:] = [\
			[0.000522302416594797	]\
		]
	beta[0,0,10,14,:,:] = [\
			[0.00074051217093356	]\
		]
	beta[0,0,10,15,:,:] = [\
			[0.000691554896394694	]\
		]
	beta[0,0,10,16,:,:] = [\
			[-0.00152858556562807	]\
		]
	beta[0,0,10,17,:,:] = [\
			[-0.00158192739851546	]\
		]
	beta[0,0,10,18,:,:] = [\
			[0.000460310267281074	]\
		]
	beta[0,0,10,19,:,:] = [\
			[0.00205012717118532	]\
		]
	beta[0,0,10,20,:,:] = [\
			[-0.00233111006695376	]\
		]
	beta[0,0,10,21,:,:] = [\
			[0.000823424340675064	]\
		]
	beta[0,0,10,22,:,:] = [\
			[0.00129003592962908	]\
		]
	beta[0,0,11,12,:,:] = [\
			[-0.00110777804085353	]\
		]
	beta[0,0,11,13,:,:] = [\
			[0.00194314309911628	]\
		]
	beta[0,0,11,14,:,:] = [\
			[-0.000146421134750505	]\
		]
	beta[0,0,11,15,:,:] = [\
			[5.42735232190165E-05	]\
		]
	beta[0,0,11,16,:,:] = [\
			[0.000809952782998715	]\
		]
	beta[0,0,11,17,:,:] = [\
			[-0.00267774232086033	]\
		]
	beta[0,0,11,18,:,:] = [\
			[0.000483736497600699	]\
		]
	beta[0,0,11,19,:,:] = [\
			[-6.63740138803213E-05	]\
		]
	beta[0,0,11,20,:,:] = [\
			[0.00251364950144122	]\
		]
	beta[0,0,11,21,:,:] = [\
			[-0.00100644269747038	]\
		]
	beta[0,0,11,22,:,:] = [\
			[0.00228925316588272	]\
		]
	beta[0,0,12,13,:,:] = [\
			[0.00158420123935693	]\
		]
	beta[0,0,12,14,:,:] = [\
			[-0.000697574905362528	]\
		]
	beta[0,0,12,15,:,:] = [\
			[-0.00245771049188443	]\
		]
	beta[0,0,12,16,:,:] = [\
			[0.000808173937823015	]\
		]
	beta[0,0,12,17,:,:] = [\
			[-0.000710695599982104	]\
		]
	beta[0,0,12,18,:,:] = [\
			[0.00182656882244503	]\
		]
	beta[0,0,12,19,:,:] = [\
			[-0.00184359676878401	]\
		]
	beta[0,0,12,20,:,:] = [\
			[-0.00164037899922662	]\
		]
	beta[0,0,12,21,:,:] = [\
			[0.000341544410076675	]\
		]
	beta[0,0,12,22,:,:] = [\
			[0.00102803784941996	]\
		]
	beta[0,0,13,14,:,:] = [\
			[-0.000376177593532041	]\
		]
	beta[0,0,13,15,:,:] = [\
			[0.0023013357888197	]\
		]
	beta[0,0,13,16,:,:] = [\
			[0.000228344222708485	]\
		]
	beta[0,0,13,17,:,:] = [\
			[0.0023000711795569	]\
		]
	beta[0,0,13,18,:,:] = [\
			[-0.00152970924722482	]\
		]
	beta[0,0,13,19,:,:] = [\
			[0.00370625981582872	]\
		]
	beta[0,0,13,20,:,:] = [\
			[0.00213090070294489	]\
		]
	beta[0,0,13,21,:,:] = [\
			[9.27356841471413E-06	]\
		]
	beta[0,0,13,22,:,:] = [\
			[-0.00072932355848588	]\
		]
	beta[0,0,14,15,:,:] = [\
			[0.000951448197921269	]\
		]
	beta[0,0,14,16,:,:] = [\
			[0.000509374300146272	]\
		]
	beta[0,0,14,17,:,:] = [\
			[-0.00116427369435975	]\
		]
	beta[0,0,14,18,:,:] = [\
			[0.000463153314828609	]\
		]
	beta[0,0,14,19,:,:] = [\
			[-0.000230093929482328	]\
		]
	beta[0,0,14,20,:,:] = [\
			[-0.000665984070055677	]\
		]
	beta[0,0,14,21,:,:] = [\
			[-0.00162387337365804	]\
		]
	beta[0,0,14,22,:,:] = [\
			[0.000322735390771911	]\
		]
	beta[0,0,15,16,:,:] = [\
			[-3.2516257300213E-06	]\
		]
	beta[0,0,15,17,:,:] = [\
			[0.000324705432259723	]\
		]
	beta[0,0,15,18,:,:] = [\
			[-3.59328274784575E-05	]\
		]
	beta[0,0,15,19,:,:] = [\
			[-0.000610520728018289	]\
		]
	beta[0,0,15,20,:,:] = [\
			[-0.000840778398118124	]\
		]
	beta[0,0,15,21,:,:] = [\
			[0.000491418276325254	]\
		]
	beta[0,0,15,22,:,:] = [\
			[-0.000800775573335389	]\
		]
	beta[0,0,16,17,:,:] = [\
			[0.00157143107977101	]\
		]
	beta[0,0,16,18,:,:] = [\
			[0.00102555044988131	]\
		]
	beta[0,0,16,19,:,:] = [\
			[-0.000460352166650971	]\
		]
	beta[0,0,16,20,:,:] = [\
			[0.00196831718456707	]\
		]
	beta[0,0,16,21,:,:] = [\
			[-0.00258140300099847	]\
		]
	beta[0,0,16,22,:,:] = [\
			[0.00181856680733468	]\
		]
	beta[0,0,17,18,:,:] = [\
			[-0.000102819583956265	]\
		]
	beta[0,0,17,19,:,:] = [\
			[-0.00332902438115523	]\
		]
	beta[0,0,17,20,:,:] = [\
			[-0.000624102855581205	]\
		]
	beta[0,0,17,21,:,:] = [\
			[-0.00119310833062768	]\
		]
	beta[0,0,17,22,:,:] = [\
			[-0.000639846207784729	]\
		]
	beta[0,0,18,19,:,:] = [\
			[-0.00255617387634169	]\
		]
	beta[0,0,18,20,:,:] = [\
			[0.00221597027622122	]\
		]
	beta[0,0,18,21,:,:] = [\
			[0.000129439055267976	]\
		]
	beta[0,0,18,22,:,:] = [\
			[0.00385936034921781	]\
		]
	beta[0,0,19,20,:,:] = [\
			[-0.00222751485854507	]\
		]
	beta[0,0,19,21,:,:] = [\
			[0.00220425332653061	]\
		]
	beta[0,0,19,22,:,:] = [\
			[0.00156971707314905	]\
		]
	beta[0,0,20,21,:,:] = [\
			[-0.000861610968099285	]\
		]
	beta[0,0,20,22,:,:] = [\
			[0.00202053962585061	]\
		]
	beta[0,0,21,22,:,:] = [\
			[0.00150861538044363	]\
		]


# Compute the function output
	f_y = np.zeros((m1, m2, x_in.shape[1]))

	for m1_ in range(m1):
		for m2_ in range(m2):

			# Evaluate first-order indices
			first_order_ind = np.zeros(x_in.shape)

			sumf = np.zeros(x_in.shape)
			for n_ in range(n):
				for maxA_ in range(maxAlpha):
					sumf[n_,:] = sumf[n_,:]+alpha[m1_,m2_,n_,maxA_]*np.polyval(lsp.LegendreShiftPoly(maxA_+1),x_in[n_,:])
				first_order_ind[n_,:] = first_order_ind[n_,:] + sumf[n_,:]

			first_order_ind_total = np.sum(first_order_ind,axis=0)

			# Evaluate second-order indices
			second_order_ind = np.zeros((n*(n-1)//2, x_in.shape[1]))

			nij = -1
			sumf = np.zeros((n*(n-1)//2, x_in.shape[1]))
			for n1_ in range(n-1):
				for n2_ in range(n1_+1,n):
					nij = nij + 1
					for u in range(maxBeta):
						for v in range(maxBeta):
							sumf[nij,:] = sumf[nij,:]+beta[m1_,m2_,n1_,n2_,u,v]*np.polyval(lsp.LegendreShiftPoly(u+1),x_in[n1_,:])*np.polyval(lsp.LegendreShiftPoly(v+1),x_in[n2_,:])
					second_order_ind[nij,:] = second_order_ind[nij,:] + sumf[nij,:]

			second_order_ind_total = np.sum(second_order_ind,axis=0)

			# Evaluate the function output
			f_y[m1_,m2_,:]=(f0[m1_,m2_] + first_order_ind_total+second_order_ind_total)


	y_out = f_y
	return (y_out, varargout)


if __name__ == '__main__' :
	x_in = sys.argv[1]
	(yout, (m1, m2)) = Metamodel_HDMR(x_in)
	print(yout)
